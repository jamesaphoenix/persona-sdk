---
title: React Hooks
description: React hooks for persona generation and management
---

# React Hooks

React hooks for integrating persona generation into React applications.

## Installation

```bash
npm install @jamesaphoenix/persona-sdk react
```

## Setup

Wrap your app with the PersonaProvider.

```tsx
import { PersonaProvider } from '@jamesaphoenix/persona-sdk/react';

function App() {
  return (
    <PersonaProvider 
      apiUrl="http://localhost:3000"
      apiKey={process.env.REACT_APP_OPENAI_KEY}
    >
      <YourApp />
    </PersonaProvider>
  );
}
```

## usePersona

Generate and manage a single persona.

```typescript
function usePersona(
  initialConfig?: PersonaConfig
): {
  persona: Persona | null;
  loading: boolean;
  error: Error | null;
  generate: (config?: PersonaConfig) => Promise<void>;
  update: (attributes: Partial<PersonaAttributes>) => void;
  reset: () => void;
}
```

### Example

```tsx
import { usePersona } from '@jamesaphoenix/persona-sdk/react';

function UserProfile() {
  const { persona, loading, generate } = usePersona();

  useEffect(() => {
    generate({
      age: { type: 'normal', mean: 35, stdDev: 5 },
      occupation: 'Developer'
    });
  }, []);

  if (loading) return <div>Generating persona...</div>;
  
  return (
    <div>
      <h2>{persona?.name}</h2>
      <p>Age: {persona?.attributes.age}</p>
      <p>Role: {persona?.attributes.occupation}</p>
    </div>
  );
}
```

## usePersonaGroup

Manage collections of personas.

```typescript
function usePersonaGroup(
  initialName?: string
): {
  group: PersonaGroup | null;
  loading: boolean;
  error: Error | null;
  generate: (config: GroupConfig) => Promise<void>;
  addPersona: (persona: Persona) => void;
  removePersona: (id: string) => void;
  getStatistics: (attribute: string) => Statistics;
  filter: (predicate: (p: Persona) => boolean) => Persona[];
}
```

### Example

```tsx
import { usePersonaGroup } from '@jamesaphoenix/persona-sdk/react';

function AudienceAnalytics() {
  const { group, generate, getStatistics } = usePersonaGroup('Users');

  const handleGenerate = () => {
    generate({
      size: 1000,
      distributions: {
        age: { type: 'normal', mean: 32, stdDev: 8 },
        occupation: {
          type: 'categorical',
          options: [
            { value: 'Developer', probability: 0.4 },
            { value: 'Designer', probability: 0.3 },
            { value: 'Manager', probability: 0.3 }
          ]
        }
      }
    });
  };

  const ageStats = group ? getStatistics('age') : null;

  return (
    <div>
      <button onClick={handleGenerate}>Generate Audience</button>
      {ageStats && (
        <div>
          <h3>Age Distribution</h3>
          <p>Average: {ageStats.mean?.toFixed(1)}</p>
          <p>Range: {ageStats.min} - {ageStats.max}</p>
        </div>
      )}
    </div>
  );
}
```

## useAIInsights

Generate AI-powered insights from personas.

```typescript
function useAIInsights<T = any>(
  schema?: ZodType<T>
): {
  insights: T | null;
  loading: boolean;
  error: Error | null;
  generate: (
    personas: Persona | PersonaGroup,
    prompt?: string
  ) => Promise<void>;
}
```

### Example

```tsx
import { useAIInsights } from '@jamesaphoenix/persona-sdk/react';
import { z } from 'zod';

const InsightsSchema = z.object({
  segments: z.array(z.object({
    name: z.string(),
    size: z.number(),
    characteristics: z.array(z.string())
  })),
  recommendations: z.array(z.string())
});

function MarketingDashboard() {
  const { group } = usePersonaGroup();
  const { insights, generate } = useAIInsights(InsightsSchema);

  const analyzeAudience = async () => {
    if (group) {
      await generate(group, "Identify market segments and recommendations");
    }
  };

  return (
    <div>
      <button onClick={analyzeAudience}>Analyze Audience</button>
      {insights?.segments.map(segment => (
        <div key={segment.name}>
          <h4>{segment.name} ({segment.size} users)</h4>
          <ul>
            {segment.characteristics.map(char => (
              <li key={char}>{char}</li>
            ))}
          </ul>
        </div>
      ))}
    </div>
  );
}
```

## useDistributionSelector

AI-powered distribution selection.

```typescript
function useDistributionSelector(): {
  distributions: DistributionMap | null;
  reasoning: string | null;
  loading: boolean;
  error: Error | null;
  select: (params: DistributionSelectionParams) => Promise<void>;
}
```

### Example

```tsx
import { useDistributionSelector } from '@jamesaphoenix/persona-sdk/react';

function SmartGroupGenerator() {
  const { distributions, reasoning, select } = useDistributionSelector();
  const { generate } = usePersonaGroup();

  const handleSmartGenerate = async () => {
    await select({
      description: "Tech conference attendees",
      requirements: [
        "Mostly experienced professionals",
        "Some students and beginners",
        "International audience"
      ]
    });

    if (distributions) {
      await generate({
        size: 500,
        distributions
      });
    }
  };

  return (
    <div>
      <button onClick={handleSmartGenerate}>
        Generate Smart Audience
      </button>
      {reasoning && (
        <div>
          <h4>AI Reasoning</h4>
          <p>{reasoning}</p>
        </div>
      )}
    </div>
  );
}
```

## usePersistedPersonas

Work with database-persisted personas.

```typescript
function usePersistedPersonas(): {
  personas: Persona[];
  loading: boolean;
  error: Error | null;
  fetch: (params?: FetchParams) => Promise<void>;
  create: (config: PersonaConfig) => Promise<Persona>;
  update: (id: string, attributes: Partial<PersonaAttributes>) => Promise<void>;
  delete: (id: string) => Promise<void>;
  pagination: {
    page: number;
    totalPages: number;
    totalCount: number;
    setPage: (page: number) => void;
  };
}
```

### Example

```tsx
import { usePersistedPersonas } from '@jamesaphoenix/persona-sdk/react';

function PersonaManager() {
  const { 
    personas, 
    fetch, 
    create, 
    delete: deletePersona,
    pagination 
  } = usePersistedPersonas();

  useEffect(() => {
    fetch({ page: 1, limit: 20 });
  }, []);

  return (
    <div>
      <h3>Saved Personas</h3>
      <div>
        {personas.map(persona => (
          <div key={persona.id}>
            <span>{persona.name}</span>
            <button onClick={() => deletePersona(persona.id)}>
              Delete
            </button>
          </div>
        ))}
      </div>
      <div>
        Page {pagination.page} of {pagination.totalPages}
        <button onClick={() => pagination.setPage(pagination.page + 1)}>
          Next
        </button>
      </div>
    </div>
  );
}
```

## Custom Hooks

Build your own hooks using the core SDK.

```tsx
import { useState, useCallback } from 'react';
import { 
  PersonaGroup, 
  NormalDistribution 
} from '@jamesaphoenix/persona-sdk';

function useABTestAudience() {
  const [controlGroup, setControlGroup] = useState<PersonaGroup | null>(null);
  const [testGroup, setTestGroup] = useState<PersonaGroup | null>(null);

  const generateABTest = useCallback(async (size: number) => {
    // Control: Younger audience
    const control = new PersonaGroup('Control');
    control.generateFromDistributions(size / 2, {
      age: new NormalDistribution(25, 3),
      occupation: 'Developer',
      sex: 'other'
    });
    setControlGroup(control);

    // Test: Older audience  
    const test = new PersonaGroup('Test');
    test.generateFromDistributions(size / 2, {
      age: new NormalDistribution(40, 5),
      occupation: 'Developer', 
      sex: 'other'
    });
    setTestGroup(test);
  }, []);

  return {
    controlGroup,
    testGroup,
    generateABTest
  };
}
```

## TypeScript Support

All hooks are fully typed with TypeScript.

```tsx
interface CustomAttributes extends PersonaAttributes {
  subscriptionTier: 'free' | 'pro' | 'enterprise';
  monthlySpend: number;
}

function TypedExample() {
  // Type inference works automatically
  const { persona, generate } = usePersona<CustomAttributes>();

  const upgrade = () => {
    if (persona) {
      // TypeScript knows about subscriptionTier
      console.log(persona.attributes.subscriptionTier);
    }
  };

  return <button onClick={upgrade}>Check Tier</button>;
}
```

## Performance Optimization

Hooks include built-in optimizations.

```tsx
function OptimizedList() {
  const { group, filter } = usePersonaGroup();

  // Memoized filtering
  const premiumUsers = useMemo(
    () => filter(p => p.attributes.tier === 'premium'),
    [group] // Only re-filter when group changes
  );

  // Virtualized rendering for large lists
  return (
    <VirtualList
      items={premiumUsers}
      renderItem={(persona) => (
        <PersonaCard key={persona.id} persona={persona} />
      )}
    />
  );
}
```

## Error Handling

All hooks provide error states.

```tsx
function ErrorBoundaryExample() {
  const { persona, error, generate } = usePersona();

  if (error) {
    return (
      <ErrorDisplay 
        error={error}
        retry={() => generate()}
      />
    );
  }

  return <PersonaDisplay persona={persona} />;
}
```